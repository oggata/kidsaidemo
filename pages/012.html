<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">

<script src="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pixi.js@6.5.2/dist/browser/pixi.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pixi-live2d-display/dist/index.min.js"></script>


<input type="text" id="text" name="text" value="みんな楽しく遊ぼうね" placeholder="テキストを入力" />

<script>
function readAloud() {
  // テキストを取得
  const text = document.getElementById("text").value

  // ブラウザにWeb Speech API Speech Synthesis機能があるか判定
  if ('speechSynthesis' in window) {
    // 発言を設定
    const uttr = new SpeechSynthesisUtterance()
    uttr.text = text
    // 発言を再生
    window.speechSynthesis.speak(uttr)

  } else {
    alert('大変申し訳ありません。このブラウザは音声合成に対応していません。')
  }
}
</script>


<button id="btn">おんせいにんしき</button>

<button onclick="readAloud()">おんせい</button>
    <div id="content"></div>


<canvas id=canvas></canvas>




<script>
  
const cubism2Model =
  "../012/012.model3.json";

(async function main() {
  const app = new PIXI.Application({
    view: document.getElementById("canvas"),
    autoStart: true,
    backgroundColor: 0xffffff,
    resizeTo: window
  });

  const model2 = await PIXI.live2d.Live2DModel.from(cubism2Model);

  app.stage.addChild(model2);

  model2.scale.set(0.5);
  model2.x = 200;

})();




</script>

<script>
    const speech = new webkitSpeechRecognition();
    speech.lang = 'ja-JP';

    const btn = document.getElementById('btn');
    const content = document.getElementById('content');

    btn.addEventListener('click' , function() {
        speech.start();
    });

    speech.onresult = function(e) {
         speech.stop();
         if(e.results[0].isFinal){
             var autotext =  e.results[0][0].transcript
             document.getElementById("text").value = autotext
             //content.innerHTML += '<div>'+ autotext +'</div>';
          }
     }

     speech.onend = () => { 
        speech.start() 
     };

</script>


